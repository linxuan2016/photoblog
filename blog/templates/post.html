{% extends "base.html" %}
{% load comments %}

{% block content %}
<div class="photo-slideshow">
    <img src="{{ post.post_image.url }}" alt="{{post.image_name}}">
</div>
<div class="post-container">
<div class="post-content" style="background-color: #f8f8f8;">
    <h2>{{post.title}}</h2>
    <p>{{post.date}}</p>
    <p>{{post.content}}</p>
</div>
<div class="post-comment" style="margin-top:2cm;">
    {% get_comment_count for post as comment_count %}
    <p>This article has {{ comment_count }} comments.</p>
    {% get_comment_list for post as comment_list %}
    {% include 'comments/list.html'%}

    {% get_comment_form for post as form %}
    {% if user.is_authenticated %}
        <form action="{% comment_form_target %}" method="POST">
        {% csrf_token %}
        {{ form.comment }}
        {{ form.content_type }}
        {{ form.object_pk }}
        {{ form.timestamp }}
        {{ form.security_hash }}
        <input type="hidden" name="next" value="{% url 'post_detail' post.id %}" />
        <input type="submit" value="Add comment" id="id_submit" />
        </form>
    {% else %}
         <table>
          <form action="{% comment_form_target %}" method="post">
            {% csrf_token %}
            {{ form }}
            <tr>
              <td colspan="2">
                <input type="submit" name="submit" value="Post">
                <input type="hidden" name="next" value="{% url 'post_detail' post.id %}" />
              </td>
            </tr>
          </form>
        </table>
    {% endif %}
</div>
</div>
{% endblock %}

